<!DOCTYPE html>
<html lang="en">

<head>
    <title></title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        * {
            margin: 0;
            padding: 0;
        }
        
        #toolbar {
            width: 285px;
            box-sizing: border-box;
            border-right: 1px #666 solid;
            position: absolute;
            height: 100%;
            overflow-y: auto;
        }
        
        #toolbar h3 {
            background-color: #EEE;
            line-height: 36px;
            padding-left: 10px;
            margin-bottom: 10px;
        }
        
        #svgType {
            margin-bottom: 10px;
        }
        
        .typeButton {
            width: 50px;
            height: 26px;
            margin-left: 8px;
            border: 1px #eee solid;
            border-radius: 5px;
            box-shadow: 0;
            display: inline-block;
            text-align: center;
            font-size: 12px;
            line-height: 26px;
            cursor: pointer
        }
        
        .typeButton:hover {
            border: 1px #0088cc solid;
        }
        
        #toolbar .buttonSelected {
            border: 1px #50b400 solid;
        }
        
        #shape_attrs ul li {
            margin-bottom: 10px;
            box-sizing: border-box;
            width: 100%;
            padding-left: 8px;
        }
        
        #shape_attrs ul li label {
            display: inline-block;
            width: 65px;
            font-size: 12px;
        }
        
        .hidden {
            display: none;
        }
        #container{
            position: absolute;
            left: 290px;
            top: 10px;
            box-shadow: 2px 2px 10px rgba(0, 0, 0,0.4);
            border-radius: 5px;
            bottom: 10px;
            right: 5px;
        }
        #container [svgType]{
            cursor: pointer
        }
    </style>
</head>

<body>
    <div id="toolbar">
        <div id="svgType">
            <h3>类型</h3>
            <div class="typeButton" data-type='rect'>矩形</div>
            <div class="typeButton" data-type='circle'>圆形</div>
            <div class="typeButton" data-type='ellipse'>椭圆</div>
            <div class="typeButton" data-type='line'>直线</div>
        </div>
        <div id="svfAttrs">
            <h3>属性</h3>
            <form id='shape_attrs'>
                <ul>
                    <!--Rect Start-->
                    <li data-shape='rect' class="hidden">
                        <label for="rect_x">X:</label>
                        <input type="number" id='rect_x' />
                    </li>
                    <li data-shape='rect' class="hidden">
                        <label for="rect_y">Y:</label>
                        <input type="number" id='rect_y' />
                    </li>
                    <li data-shape='rect' class="hidden">
                        <label for="rect_width">Width:</label>
                        <input type="number" id='rect_width' />
                    </li>
                    <li data-shape='rect' class="hidden">
                        <label for="rect_height">Height:</label>
                        <input type="number" id='rect_height' />
                    </li>
                    <li data-shape='rect' class="hidden">
                        <label for="rect_rx">RX:</label>
                        <input type="number" id='rect_rx' />
                    </li>
                    <li data-shape='rect' class="hidden">
                        <label for="rect_ry">RY:</label>
                        <input type="number" id='rect_ry' />
                    </li>
                    <!--Rect end-->
                    <!--Circle Start-->
                    <li data-shape='circle' class="hidden">
                        <label for="circle_cx">CX:</label>
                        <input type="number" id='circle_cx' />
                    </li>
                    <li data-shape='circle' class="hidden">
                        <label for="circle_cy">CY:</label>
                        <input type="number" id='circle_cy' />
                    </li>
                    <li data-shape='circle' class="hidden">
                        <label for="circle_r">R:</label>
                        <input type="number" id='circle_r' />
                    </li>
                    <!--Circle end-->
                    <!--Ellipse Start-->
                    <li data-shape='ellipse' class="hidden">
                        <label for="ellipse_cx">CX:</label>
                        <input type="number" id='ellipse_cx' />
                    </li>
                    <li data-shape='ellipse' class="hidden">
                        <label for="ellipse_cy">CY:</label>
                        <input type="number" id='ellipse_cy' />
                    </li>
                    <li data-shape='ellipse' class="hidden">
                        <label for="ellipse_rx">RX:</label>
                        <input type="number" id='ellipse_rx' />
                    </li>
                    <li data-shape='ellipse' class="hidden">
                        <label for="ellipse_ry">RY:</label>
                        <input type="number" id='ellipse_ry' />
                    </li>
                    <!--Ellipse end-->
                    <!--line Start-->
                    <li data-shape='line' class="hidden">
                        <label for="line_x1">X1:</label>
                        <input type="number" id='line_x1' />
                    </li>
                    <li data-shape='line' class="hidden">
                        <label for="line_y1">Y1:</label>
                        <input type="number" id='line_y1' />
                    </li>
                    <li data-shape='line' class="hidden">
                        <label for="line_x2">X2:</label>
                        <input type="number" id='line_x2' />
                    </li>
                    <li data-shape='line' class="hidden">
                        <label for="line_y2"> Y2:</label>
                        <input type="number" id='line_y2' />
                    </li>
                    <!--line end-->
                    <!--public attrs start-->
                    <li data-shape='all' class="hidden">
                        <label for="fill">填充色:</label>
                        <input type="color" value='#ffffff' id='fill' />
                    </li>
                    <li data-shape='all' class="hidden">
                        <label for="rectStrokeColor">描边:</label>
                        <input type="color" value='#000000' id='strokeColor' />
                        <input type="range" value='1' min='0' max='50' id='stroke-width' />
                    </li>
                    <li data-shape='all' class="hidden">
                        <label for="translateX">translateX:</label>
                        <input type="number" id='translateX' />
                    </li>
                    <li data-shape='all' class="hidden">
                        <label for="translateY">translateY:</label>
                        <input type="number" id='translateY' />
                    </li>
                    <li data-shape='all' class="hidden">
                        <label for="rotate">rotate:</label>
                        <input type="range" value='0' min='-180' max='180' id='rotate' />
                    </li>
                    <li data-shape='all' class="hidden">
                        <label for="scale">scale:</label>
                        <input type="range" value='1' min='-1' max='2' step="0.1" value="1" id='scale' />
                    </li>
                    <!--public attrs end-->
                </ul>
            </form>
        </div>
    </div>
    <div id="container">

    </div>
</body>
<script>
    //默认配置
    var defaultConfig = {
        rect:{
            x : 0,
            y : 0,
            width : 100,
            height : 50,
            rx : 0,
            ry : 0
        },
        circle:{
            cx : 50,
            cy : 50,
            r : 50
        },
        ellipse:{
            cx : 60,
            cy : 50,
            rx : 60,
            ry : 50
        },
        line:{
            x1 : 0,
            y1 : 0,
            x2 : 50,
            y2 : 50
        },
        public:{
            fill : "#ffffff",
            stroke: "#000000",
            "stroke-width": "1"
        }
    };
    //当前编辑对象
    var currentDom = null;
    //创建SVG元素
    var SVF_NS = 'http://www.w3.org/2000/svg';
    var svg = document.createElementNS(SVF_NS, 'svg');
    svg.setAttribute('width','100%');
    svg.setAttribute('height','100%');
    document.getElementById('container').appendChild(svg);
    //按钮点击事件
    document.getElementById('svgType').addEventListener('click', function (e) {
        if (e.target && e.target.className.indexOf('typeButton') !== -1) {
            currentDom = null;
            //添加选中样式
            removeClass(document.querySelectorAll('.typeButton'), 'buttonSelected');
            addClass(e.target, 'buttonSelected');
            //显示类型对应的配置项
            addClass(document.querySelectorAll('[data-shape]'), 'hidden');
            removeClass(document.querySelectorAll('[data-shape="all"]'),
                'hidden');
            removeClass(document.querySelectorAll('[data-shape="' + e.target.getAttribute('data-type') + '"]'),
                'hidden');
            drawShape(e.target.getAttribute('data-type'));
        }
        e.preventDefault();
        e.stopPropagation();
    }, false);
    /*
        移除class
    */
    function removeClass(dom, className) {
        if (!dom) {
            return;
        }
        var reg = new RegExp('\\b(' + className + ')\\b', 'gim');
        if (dom.length) {
            for (var i = 0; i < dom.length; i++) {
                dom[i].className = dom[i].className.replace(reg, "").trim();
            }
        } else {
            dom.className = dom.className.replace(reg, "").trim();
        }
    };
    /*
        添加class
    */
    function addClass(dom, className) {
        if (!dom) {
            return;
        }
        var reg = new RegExp('\\s*\\b(' + className + ')\\b\\s*', 'gim');
        if (dom.length) {
            for (var i = 0; i < dom.length; i++) {
                if (!reg.test(dom[i].className.trim())) {
                   dom[i].className = dom[i].className.trim() + " " + className;
                }
                reg.lastIndex = 0;
            }
        } else {
            if (!reg.test(dom.className.trim())) {
                dom.className = dom.className.trim() + " " + className;
            }
            reg.lastIndex = 0;
        }
    }
    /*
        显示类型属性配置
    */
    function showAttrsConfig(type) {
    }
    /*
        显示元素
    */
    function showDom(selector) {}
    /*
        隐藏元素
    */
    function hiddenDom(selector) {
    }
    /*
        创建图形
    */
    function drawShape(type){
        if(!currentDom){
            var svgDom = document.createElementNS(SVF_NS, type);
            svgDom.setAttribute("svgType",type);
            for (var attr in defaultConfig[type]){
                svgDom.setAttribute(attr,defaultConfig[type][attr]);
            }
            for(var attr in defaultConfig.public){
                svgDom.setAttribute(attr,defaultConfig.public[attr]);
            }
            currentDom = svgDom;
            document.querySelector('svg').appendChild(svgDom);
            setInputValue(true,type);
        }else{

        }
        
    }

    /*
        监听输入框事件
    */
    document.getElementById("shape_attrs").addEventListener('input',function(){
        getInputConfig();
    });

    /*
        获取输入框的值
    */
    function getInputConfig(){
        var inputObjList = document.getElementById("shape_attrs").querySelectorAll('input');
        var configObj = {};
        for(var i = 0; i < inputObjList.length; i++){
            var dataShape = inputObjList[i].parentNode.getAttribute('data-shape');
            var nodeName = currentDom.nodeName.toLowerCase();
            if(dataShape === nodeName || dataShape === 'all'){
                var shapeAttr = inputObjList[i].getAttribute("id").toLowerCase().replace('nodeName','');
                currentDom.setAttribute(shapeAttr.replace(nodeName+"_",""),inputObjList[i].value);
            }
        }
    }

    function setInputValue(isAdd,type){
        if(isAdd){
            var defaultCfg = defaultConfig[type];
            for(var cfg in defaultCfg){
                document.getElementById(type+"_"+cfg).value = defaultCfg[cfg];
            }
            
        }else{
            //TODO:动态获取已绘制图形的属性值
        }
    }
</script>

</html>
